{% extends 'main/base.html' %}
<!--عرض شكاوي بحيث المستخدم مايخرج الا شكاوي حقتة والادمن يشوف كل الشكاوي-->
{% block content %}
<!--<h2>عرض الشكاوى</h2>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>اسم المستخدم</th>
            <th>الرسالة</th>
            <th>الحالة</th>
            <th>تاريخ الرسالة</th>
            <th>رد</th>
        </tr>
    </thead>
    <tbody>
        {% for report in reports %}
            <tr>
                <td>{{ report.user.username }}</td>
                <td>{{ report.description }}</td>
                <td>
                    {% if report.status == 'open' %}
                        مفتوحة
                    {% elif report.status == 'in_progress' %}
                        قيد المعالجة
                    {% else %}
                        مغلقة
                    {% endif %}
                </td>
                <td>{{ report.created_at }}</td>
                <td>
                    <a href="{% url 'administration:reply_to_report_view' report.id %}">
                        <i class="fas fa-reply"></i> 
                    </a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>-->



<h2>عرض الشكاوى</h2>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>اسم المستخدم</th>
            <th>الرسالة</th>
            <th>الحالة</th>
            <th>تاريخ الرسالة</th>
            <th>الإجراء</th>
        </tr>
    </thead>
    <tbody>
        {% for report in reports %}
            <tr>
                <td>{{ report.user.username }}</td>
                <td>{{ report.description }}</td>
                <td>
                    {% if report.status == 'open' %}
                        مفتوحة
                    {% elif report.status == 'in_progress' %}
                        قيد المعالجة
                    {% else %}
                        مغلقة
                    {% endif %}
                </td>
                <td>{{ report.created_at }}</td>
                <td>
                    {% if request.user.is_staff %}
                        <!-- إذا كان المستخدم إدمن يظهر له زر الرد -->
                        <a href="{% url 'administration:reply_to_report_view' report.id %}">
                            <i class="fas fa-reply"></i> 
                        </a>
                    {% else %}
                        <!-- إذا كان مستخدم عادي يظهر له زر لعرض الرد -->
                        {% if report.reply %}
                            <a href="{% url 'administration:view_report_reply' report.id %}">
                                <i class="fas fa-eye"></i> <!-- أيقونة عرض -->
                            </a>
                        {% else %}
                            لا يوجد رد بعد
                        {% endif %}
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{%endblock%}
